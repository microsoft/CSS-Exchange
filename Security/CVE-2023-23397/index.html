
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://microsoft.github.io/CSS-Exchange/Security/CVE-2023-23397/">
      
      
        <link rel="prev" href="../../Search/Troubleshoot-ModernSearch/">
      
      
        <link rel="next" href="FAQ/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.5">
    
    
      
        <title>CVE-2023-23397 script - Microsoft - CSS-Exchange</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7a7fce14.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"/></svg>');}</style>


    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cve-2023-23397-script" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Microsoft - CSS-Exchange" class="md-header__button md-logo" aria-label="Microsoft - CSS-Exchange" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Microsoft - CSS-Exchange
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CVE-2023-23397 script
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/microsoft/CSS-Exchange" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Microsoft - CSS-Exchange" class="md-nav__button md-logo" aria-label="Microsoft - CSS-Exchange" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Microsoft - CSS-Exchange
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/microsoft/CSS-Exchange" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Emerging-Issues/" class="md-nav__link">
        Emerging Issues
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Admin
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Admin
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Admin/Clear-MailboxPermission/" class="md-nav__link">
        Clear-MailboxPermission
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Admin/CrossTenantMailboxMigrationValidation/" class="md-nav__link">
        Cross-TenantMailboxMigrationValidation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Admin/Find-AmbiguousSids/" class="md-nav__link">
        Find-AmbiguousSids
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Admin/Get-EASMailboxLogs/" class="md-nav__link">
        Get-EASMailboxLogs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Admin/Get-SimpleAuditLogReport/" class="md-nav__link">
        Get-SimpleAuditLogReport
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Admin/MonitorExchangeAuthCertificate/" class="md-nav__link">
        MonitorExchangeAuthCertificate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Admin/Remove-CertExpiryNotifications/" class="md-nav__link">
        Remove-CertExpiryNotifications
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Admin/Reset-ScanEngineVersion/" class="md-nav__link">
        Reset-ScanEngineVersion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Admin/SetUnifiedContentPath/" class="md-nav__link">
        SetUnifiedContentPath
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Admin/Test-AMSI/" class="md-nav__link">
        Test-AMSI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Admin/Update-Engines/" class="md-nav__link">
        Update-Engines
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Calendar
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Calendar
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Calendar/Get-CalendarDiagnosticObjectsSummary/" class="md-nav__link">
        Get-CalendarDiagnosticObjectsSummary
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Databases
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Databases
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Databases/Analyze-SpaceDump/" class="md-nav__link">
        Analyze-SpaceDump
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Databases/Compare-MailboxStatistics/" class="md-nav__link">
        Compare-MailboxStatistics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Databases/VSSTester/" class="md-nav__link">
        VSSTester
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Diagnostics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Diagnostics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/ExchangeLogCollector/" class="md-nav__link">
        ExchangeLogCollector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/ExTRA/" class="md-nav__link">
        ExTRA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/FindFrontEndActivity/FindFrontEndActivity/" class="md-nav__link">
        FindFrontEndActivity
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../Diagnostics/HealthChecker/">HealthChecker</a>
          
            <label for="__nav_5_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5_4">
          <span class="md-nav__icon md-icon"></span>
          HealthChecker
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/ExchangeServerMaintenanceCheck/" class="md-nav__link">
        MaintenanceCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/MAPIFrontEndAppPoolGCModeCheck/" class="md-nav__link">
        GCModeCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/RebootPending/" class="md-nav__link">
        RebootPending
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/CTSProcessorAffinityPercentageCheck/" class="md-nav__link">
        CTSProcessorAffinityCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/CredentialGuardCheck/" class="md-nav__link">
        CredentialGuardCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/RPCMinConnectionTimeoutCheck/" class="md-nav__link">
        RPCMinConnectionTimeoutCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/TCPIPSettingsCheck/" class="md-nav__link">
        TCPIPSettingsCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/GeneralHardwareInformation/" class="md-nav__link">
        GeneralHardwareInformation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/HyperThreadingCheck/" class="md-nav__link">
        HyperThreadingCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/NumaBiosCheck/" class="md-nav__link">
        NumaBiosCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/ProcessorCheck/" class="md-nav__link">
        ProcessorCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/IPv6EnabledCheck/" class="md-nav__link">
        IPv6EnabledCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/PacketsLossCheck/" class="md-nav__link">
        PacketsLossCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/RSSEnabledCheck/" class="md-nav__link">
        RSSEnabledCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/SleepyNICCheck/" class="md-nav__link">
        SleepyNICCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/NETFrameworkSupportabilityCheck/" class="md-nav__link">
        NETFrameworkCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/PagefileSizeCheck/" class="md-nav__link">
        PagefileCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/VisualCRedistributableVersionCheck/" class="md-nav__link">
        VisualCCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/LMCompatibilityLevelInformationCheck/" class="md-nav__link">
        LMCompatibilityLevelInformationCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/May22SU/" class="md-nav__link">
        May22SU
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/CloudConnectorCheck/" class="md-nav__link">
        CloudConnectorCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/TLSConfigurationCheck/" class="md-nav__link">
        TLSConfigurationCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/CertificateCheck/" class="md-nav__link">
        CertificateCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/AuthCertificateCheck/" class="md-nav__link">
        AuthCertificateCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/SerializedDataSigningCheck/" class="md-nav__link">
        SerializedDataSigningCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/SettingOverridesCheck/" class="md-nav__link">
        SettingOverridesCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/InternalTransportCertificateCheck/" class="md-nav__link">
        InternalTransportCertificateCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/SMBv1Check/" class="md-nav__link">
        SMBv1Check
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/EEMSCheck/" class="md-nav__link">
        EEMSCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/AMSIIntegration/" class="md-nav__link">
        AMSICheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/VulnerabilityCheck/" class="md-nav__link">
        VulnerabilityCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/DownloadDomainCheck/" class="md-nav__link">
        DownloadDomainCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/OpenRelayDomain/" class="md-nav__link">
        OpenRelayDomainCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/FIPFSCheck/" class="md-nav__link">
        FIPFSCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/IISWebConfigCheck/" class="md-nav__link">
        IISWebConfigCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/RunHCViaSchedTask/" class="md-nav__link">
        HCScheduledTask
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/HealthChecker/ADSiteCount/" class="md-nav__link">
        ADSiteCount
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/ManagedAvailabilityTroubleshooter/" class="md-nav__link">
        ManagedAvailabilityTroubleshooter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Diagnostics/Test-ExchAVExclusions/" class="md-nav__link">
        Test-ExchAVExclusions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Hybrid
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Hybrid
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Hybrid/Test-HMAEAS/" class="md-nav__link">
        Test-HMAEAS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          M365
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          M365
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../M365/DLT365Groupsupgrade/" class="md-nav__link">
        DLT365Groupsupgrade
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          Performance
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Performance
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Performance/ExPerfWiz/" class="md-nav__link">
        ExPerfWiz
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Performance/ExPerfAnalyzer/" class="md-nav__link">
        ExPerfAnalyzer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Performance/SimplePerf/" class="md-nav__link">
        SimplePerf
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          PublicFolders
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          PublicFolders
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../PublicFolders/SourceSideValidations/" class="md-nav__link">
        SourceSideValidations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../PublicFolders/ValidateMailEnabledPublicFolders/" class="md-nav__link">
        ValidateMailEnabledPublicFolders
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../PublicFolders/ValidateEXOPFDumpster/" class="md-nav__link">
        ValidateEXOPFDumpster
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
          Retention
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Retention
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Retention/Get-MRMDetails/" class="md-nav__link">
        Get-MRMDetails
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
          Search
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Search
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Search/Troubleshoot-ModernSearch/" class="md-nav__link">
        Troubleshoot-ModernSearch
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
          Security
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          Security
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_1" checked>
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index md-nav__link--active">
          <a href="./">CVE-2023-23397</a>
          
            <label for="__nav_12_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_12_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_12_1">
          <span class="md-nav__icon md-icon"></span>
          CVE-2023-23397
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="FAQ/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../EOMT/" class="md-nav__link">
        EOMT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../EOMTv2/" class="md-nav__link">
        EOMTv2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Extended-Protection/" class="md-nav__link">
        Extended Protection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ExchangeExtendedProtectionManagement/" class="md-nav__link">
        ExchangeExtendedProtectionManagement
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ExchangeMitigations/" class="md-nav__link">
        ExchangeMitigations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Test-CVE-2021-34470/" class="md-nav__link">
        Test-CVE-2021-34470
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Test-ProxyLogon/" class="md-nav__link">
        Test-ProxyLogon
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
          Setup
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Setup/CopyMissingDlls/" class="md-nav__link">
        CopyMissingDlls
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Setup/FixInstallerCache/" class="md-nav__link">
        FixInstallerCache
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Setup/Set-ExchAVExclusions/" class="md-nav__link">
        Set-ExchAVExclusions
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13_4" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../Setup/SetupAssist/">SetupAssist</a>
          
            <label for="__nav_13_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_13_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_13_4">
          <span class="md-nav__icon md-icon"></span>
          SetupAssist
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Setup/SetupAssist/ComputersContainer/" class="md-nav__link">
        ComputersContainer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Setup/SetupAssist/ReadOnlyDomainControllerContainer/" class="md-nav__link">
        ReadOnlyDomainControllerContainer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Setup/SetupAssist/RebootPending/" class="md-nav__link">
        RebootPending
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Setup/SetupAssist/InstallWatermark/" class="md-nav__link">
        InstallWatermark
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Setup/SetupLogReviewer/" class="md-nav__link">
        SetupLogReviewer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
          Transport
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_14">
          <span class="md-nav__icon md-icon"></span>
          Transport
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Transport/Compute-TopExoRecipientsFromMessageTrace/" class="md-nav__link">
        Compute-TopExoRecipientsFromMessageTrace
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Transport/ReplayQueueDatabases/" class="md-nav__link">
        ReplayQueueDatabases
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/microsoft/CSS-Exchange/edit/main/docs/Security/CVE-2023-23397/index.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  


<h1 id="cve-2023-23397-script">CVE-2023-23397 script</h1>
<p>Download the latest release: <a href="https://github.com/microsoft/CSS-Exchange/releases/latest/download/CVE-2023-23397.ps1">CVE-2023-23397.ps1</a></p>
<p>CVE-2023-23397.ps1 is a script that checks Exchange messaging items (mail, calendar and tasks) to see whether a property is populated with a non empty string value. It is up to the admin to determine if the value is malicious or not. If required, admins can use this script to clean up the property for items that are malicious or even delete the items permanently. Please see <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-23397">CVE-2023-23397</a> for more information.</p>
<p>There are two modes for the script: Audit and Cleanup.</p>
<p><strong>Audit Mode:</strong> Script provides a CSV file with details of items that have the property populated.</p>
<p><strong>Cleanup Mode:</strong> Script performs cleanup on detected items by either clearing the property or deleting the item.</p>
<h1 id="steps-to-run-the-script">Steps to run the script:</h1>
<ol>
<li>Fulfill the requirements according to environment (i.e. On-Premises or Online)</li>
<li>
<p>Run the script in audit mode.</p>
<p>For organizations with large number of mailboxes:
It is recommended to break up the mailbox list into multiple files, so the script can be run against mailboxes in batches. Here is an example of how to break up the mailboxes into batches of 1000:</p>
<div class="highlight"><pre><span></span><code>$batchSize = 1000; $batchNumber = 1; $count = 0; Get-Mailbox -ResultSize Unlimited | Select PrimarySmtpAddress | % {
  if ($count++ -ge $batchSize) { $batchNumber++; $count = 0; }
  Export-Csv -InputObject $_ -Path &quot;Batch$batchNumber.csv&quot; -Append
}

# Then run against the batches similar to this:
Import-Csv .\BatchFileName.csv | .\CVE-2023-23397.ps1 -Environment Online
</code></pre></div>
</li>
<li>
<p>If the script execution finishes with "No vulnerable item found", no further action is required.</p>
</li>
<li>If step 2 generates CSV files, review the CSV file; if you find suspicious thing, then go to 5. If you only see blank things or paths to old .wav files, no need to go to step 5.</li>
<li>If you got suspected entries in CSV file, run the script in Cleanup mode</li>
</ol>
<h2 id="requirements">Requirements</h2>
<h3 id="prerequisites-to-run-the-script-for-exchange-server-on-premises">Prerequisites to run the script for Exchange Server (on-premises)</h3>
<p>To run this script in an on-premises Exchange Server environment, you need to use an account with the <code>ApplicationImpersonation</code> management role. You can create a new role group with the required permissions by running the following PowerShell command in an elevated Exchange Management Shell (EMS):</p>
<p><div class="highlight"><pre><span></span><code><span class="nb">New-RoleGroup</span> <span class="n">-Name</span> <span class="s2">&quot;CVE-2023-23397-Script&quot;</span> <span class="n">-Roles</span> <span class="s2">&quot;ApplicationImpersonation&quot;</span> <span class="n">-Description</span> <span class="s2">&quot;Permission to run the CVE-2023-23397 script&quot;</span>
<span class="nb">Add-RoleGroupMember</span> <span class="n">-Identity</span> <span class="s2">&quot;CVE-2023-23397-Script&quot;</span> <span class="n">-Member</span> <span class="s2">&quot;&lt;UserWhoRunsTheScript&gt;&quot;</span>
</code></pre></div>
The script uses Exchange Web Services (EWS) to fetch items from user mailboxes. So, the machine on which the script is run should be able to make EWS calls to your Exchange server.</p>
<p>You can also create a new <a href="https://learn.microsoft.com/exchange/client-developer/exchange-web-services/ews-throttling-in-exchange#throttling-policies-that-affect-ews">Throttling Policy</a> to prevent the user who runs the script from being throttled. Make sure to revert the throttling policy after youâ€™re done running the script.</p>
<p>Please note that this is for Exchange on-premises environments only.</p>
<div class="highlight"><pre><span></span><code><span class="nb">New-ThrottlingPolicy</span> <span class="s2">&quot;CVE-2023-23397-Script&quot;</span>
<span class="nb">Set-ThrottlingPolicy</span> <span class="s2">&quot;CVE-2023-23397-Script&quot;</span> <span class="n">-EWSMaxConcurrency</span> <span class="n">Unlimited</span> <span class="n">-EWSMaxSubscriptions</span> <span class="n">Unlimited</span> <span class="n">-CPAMaxConcurrency</span> <span class="n">Unlimited</span> <span class="n">-EwsCutoffBalance</span> <span class="n">Unlimited</span> <span class="n">-EwsMaxBurst</span> <span class="n">Unlimited</span> <span class="n">-EwsRechargeRate</span> <span class="n">Unlimited</span>
<span class="nb">Set-Mailbox</span> <span class="n">-Identity</span> <span class="s2">&quot;&lt;UserWhoRunsTheScript&gt;&quot;</span> <span class="n">-ThrottlingPolicy</span> <span class="s2">&quot;CVE-2023-23397-Script&quot;</span>
</code></pre></div>
<h3 id="prerequisites-to-run-the-script-for-exchange-online">Prerequisites to run the script for Exchange Online</h3>
<p>To run this script in an Exchange Online environment, you need to be a <code>Global Administrator</code> or an <code>Application Administrator</code>. The script will create an application with full access permission on all the mailboxes.</p>
<p>Furthermore it is possible to use a certificate to run the script in <code>Audit</code> and <code>Cleanup</code> mode. This is called <code>Certificate Based Authentication (CBA)</code>. The steps are outlined in the <a href="FAQ.md#what-are-the-required-steps-to-prepare-the-cve-2023-23397application-application-to-support-certificate-based-authentication-cba">FAQ section</a>.</p>
<p><strong>NOTE:</strong> The script uses Microsoft.Exchange.WebServices.dll to make EWS calls. The script will try to download the DLL and use it. However, if it is unable to, you will need to download the DLL and specify the path.</p>
<h4 id="steps-to-download-microsoftexchangewebservicesdll">Steps to Download Microsoft.Exchange.WebServices.dll:</h4>
<ul>
<li>Download the nuget package from <a href="https://api.nuget.org/v3-flatcontainer/microsoft.exchange.webservices/2.2.0/microsoft.exchange.webservices.2.2.0.nupkg">NuGet Gallery | Microsoft.Exchange.WebServices.2.2.0</a></li>
<li>Change the extension of the file from .nupkg to .zip</li>
<li>Unzip the package.</li>
<li>Use the dll present at â€œ\lib\40â€ location in the package</li>
<li>Provide the path to the DLL for the <code>-DLLPath</code> parameter when running the script.</li>
</ul>
<h2 id="how-to-run">How To Run</h2>
<h3 id="script-parameters">Script Parameters</h3>
<p>The script accepts the following parameters:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Environment</td>
<td>Specify the environment where you are running the script. This parameter is required.</td>
</tr>
<tr>
<td>CreateAzureApplication</td>
<td>Use this parameter to create an Azure AD application that can be used for running the script in Exchange Online.</td>
</tr>
<tr>
<td>DeleteAzureApplication</td>
<td>Use this parameter to delete the Azure AD application.</td>
</tr>
<tr>
<td>UserMailboxes</td>
<td>Use this parameter to provide a list of user primary SMTP addresses. You can pipe the addresses while running. This parameter is required in Audit mode.</td>
</tr>
<tr>
<td>StartTimeFilter</td>
<td>Use this parameter to provide start time filter. (Format: "mm/dd/yyyy hh:mm:ss")</td>
</tr>
<tr>
<td>EndTimeFilter</td>
<td>Use this parameter to provide end time filter. (Format: "mm/dd/yyyy hh:mm:ss")</td>
</tr>
<tr>
<td>CleanupAction</td>
<td>Use this parameter to provide type of cleanup action you want to perform (ClearProperty/ClearItem).</td>
</tr>
<tr>
<td>CleanupInfoFilePath</td>
<td>Use this parameter to provide path to the CSV file containing the details of messages to be cleaned up.</td>
</tr>
<tr>
<td>EWSExchange2013</td>
<td>Use this switch if you are running on Exchange Server 2013 mailboxes.</td>
</tr>
<tr>
<td>DLLPath</td>
<td>Provide the path to Microsoft.Exchange.WebServices.dll. This is an optional parameter.</td>
</tr>
<tr>
<td>AzureApplicationName</td>
<td>Provide the name of the application which the script should create. This is an optional parameter. The default name is CVE-2023-23397Application.</td>
</tr>
<tr>
<td>CertificateThumbprint</td>
<td>Provide the thumbprint of the certificate which was uploaded to the Azure application. The certificate must exist under the 'Cert:\CurrentUser\My' path on the machine. It can only be used if the private key exists and is accessible.</td>
</tr>
<tr>
<td>AppId</td>
<td>Provide the ID of the application which was created in Azure and which is required to run the script in audit or cleanup mode. The ID can be found within the Azure application under 'Overview' and is labeled as: 'Application (client) ID'. If you don't specify this parameter but specify the <code>CertificateThumbprint</code> parameter, the script will ask you to logon to query the required information.</td>
</tr>
<tr>
<td>Organization</td>
<td>Provide the ID of your organization. It can be provided in GUID format or by using your onmicrosoft.com domain. If you don't specify this parameter but specify the <code>CertificateThumbprint</code> parameter, the script will ask you to logon to query the required information.</td>
</tr>
<tr>
<td>AzureEnvironment</td>
<td>Provide the Azure Environment name. This is an optional parameter. The default value is <code>Global</code>.</td>
</tr>
<tr>
<td>MaxCSVLength</td>
<td>Provide the maximum number of rows the script should create in the CSV while running in Audit mode. This is an optional parameter. The default is 200,000.</td>
</tr>
<tr>
<td>EWSServerURL</td>
<td>Provide the EWS endpoint. If not provided, the script will make an Autodiscover call to get it. This parameter works only with Exchange Server.</td>
</tr>
<tr>
<td>ScriptUpdateOnly</td>
<td>This optional parameter allows you to only update the script without performing any other actions.</td>
</tr>
<tr>
<td>SkipVersionCheck</td>
<td>This optional parameter allows you to skip the automatic version check and script update.</td>
</tr>
<tr>
<td>IgnoreCertificateMismatch</td>
<td>This optional parameter lets you ignore TLS certificate mismatch errors.</td>
</tr>
<tr>
<td>Credential</td>
<td>This optional parameter lets you pass admin credentials when running on Exchange Server.</td>
</tr>
<tr>
<td>UseSearchFolders</td>
<td>This parameter causes the script to use deep-traversal search folders, significantly improving performance.</td>
</tr>
<tr>
<td>SearchFolderCleanup</td>
<td>This parameter cleans up any search folders left behind by the asynchronous search feature. It must be used together with the <code>UseSearchFolders</code> parameter.</td>
</tr>
<tr>
<td>TimeoutSeconds</td>
<td>This optional parameter specifies the timeout on the EWS ExchangeService object. The default is 300 seconds (5 minutes).</td>
</tr>
</tbody>
</table>
<h4 id="set-exchange-online-cloud-specific-values">Set Exchange Online Cloud Specific values:</h4>
<p>You can use the <code>AzureEnvironment</code> parameter to specify the cloud against which the script runs. By default, the script will run against the Global (worldwide) service. Supported values are:</p>
<table>
<thead>
<tr>
<th>AzureEnvironment</th>
<th>Cloud Environment</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>Global</td>
<td>AzureCloud</td>
<td>WW</td>
</tr>
<tr>
<td>USGovernmentL4</td>
<td>AzureUSGovernment</td>
<td>GCC</td>
</tr>
<tr>
<td>USGovernmentL5</td>
<td>AzureUSGovernment</td>
<td>DOD</td>
</tr>
<tr>
<td>ChinaCloud</td>
<td>AzureChinaCloud</td>
<td>Office365 operated by 21Vianet</td>
</tr>
</tbody>
</table>
<h3 id="running-against-exchange-server-on-premises-mailboxes">Running Against Exchange Server (On-Premises) Mailboxes</h3>
<h4 id="audit-mode">Audit Mode:</h4>
<p>Execute the script in audit mode as an admin with the ApplicationImpersonation management role. For scanning on-premises mailboxes, the Environment value should be "Onprem" and you should provide the EWS URL of your Exchange server in EWSServerURL property. The script will ask for a login prompt, and the username must be provided.</p>
<div class="admonition warning">
<p class="admonition-title">Note</p>
<p>The username which is passed to the script, must be specified in the UPN format where the domain-part is a domain accepted by the Exchange Server.</p>
</div>
<p>Optionally, you can use the Credential flag to provide admin credentials in PSCredential format. Set the EWSServerURL parameter to specify the EWS URL if the Autodiscover call fails.</p>
<h5 id="examples">Examples:</h5>
<p>This syntax runs the script to audit all the mailboxes.</p>
<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\&gt;</span> <span class="nb">Get-Mailbox</span> <span class="n">-ResultSize</span> <span class="n">Unlimited</span> <span class="p">|</span> <span class="p">.\</span><span class="n">CVE</span><span class="p">-</span><span class="n">2023</span><span class="p">-</span><span class="n">23397</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Environment</span> <span class="n">Onprem</span>
</code></pre></div>
<p>Note: If there are Exchange 2013 servers in the environment with Exchange 2016 or 2019, the script may not be able to open mailboxes on Exchange 2013 and may give the following error:</p>
<p><img alt="Exchange Server doesnâ€™t support the requested version screenshot" src="attachments/CVE-2023-23397_screenshot1.png" /></p>
<p>If the above error appears, run the script with an additional parameter EWSExchange2013, as shown below.</p>
<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\&gt;</span> <span class="nb">Get-Mailbox</span> <span class="n">-ResultSize</span> <span class="n">Unlimited</span> <span class="p">|</span> <span class="p">.\</span><span class="n">CVE</span><span class="p">-</span><span class="n">2023</span><span class="p">-</span><span class="n">23397</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Environment</span> <span class="n">Onprem</span> <span class="n">-EWSExchange2013</span>
</code></pre></div>
<p>This syntax runs the script to audit all mailboxes for items that were created during a specific period.</p>
<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\&gt;</span> <span class="nb">Get-Mailbox</span> <span class="n">-ResultSize</span> <span class="n">Unlimited</span> <span class="p">|</span> <span class="p">.\</span><span class="n">CVE</span><span class="p">-</span><span class="n">2023</span><span class="p">-</span><span class="n">23397</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Environment</span> <span class="n">Onprem</span> <span class="n">-StartTimeFilter</span> <span class="s2">&quot;01/01/2023 00:00:00&quot;</span> <span class="n">-EndTimeFilter</span> <span class="s2">&quot;01/01/2024 00:00:00&quot;</span>
</code></pre></div>
<h4 id="cleanup-mode">Cleanup Mode:</h4>
<p>The script provides a list of all the messages containing the problematic property in the mailboxes of users specified in an AuditResult_timestamp.CSV file. Admins should analyze this file and mark (with a "Y") messages for which either the property is to be cleaned or the message must be removed.</p>
<p>Step 1
Mark the messages for cleanup by entering â€œYâ€ instead of â€œNâ€ in the cleanup column of CSV file.</p>
<p>Step 2
Choose either to remove the message or only the problematic property in the next step by specifying CleanupAction as â€œClearItemâ€ or â€œClearProperty.â€ Execute the script as follows to remove the message or property marked with Y in the CSV file.</p>
<h5 id="examples_1">Examples:</h5>
<p>This syntax runs the script to clear the problematic property from messages:</p>
<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\&gt;</span> <span class="p">.\</span><span class="n">CVE</span><span class="p">-</span><span class="n">2023</span><span class="p">-</span><span class="n">23397</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Environment</span> <span class="n">Onprem</span> <span class="n">-CleanupAction</span> <span class="n">ClearProperty</span> <span class="n">-CleanupInfoFilePath</span> <span class="p">&lt;</span><span class="n">Path</span> <span class="n">to</span> <span class="n">modified</span> <span class="n">CSV</span><span class="p">&gt;</span>
</code></pre></div>
<p>This syntax runs the script to delete messages containing the malicious property</p>
<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\&gt;</span> <span class="p">.\</span><span class="n">CVE</span><span class="p">-</span><span class="n">2023</span><span class="p">-</span><span class="n">23397</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Environment</span> <span class="n">Onprem</span> <span class="n">-CleanupAction</span> <span class="n">ClearItem</span> <span class="n">-CleanupInfoFilePath</span> <span class="p">&lt;</span><span class="n">Path</span> <span class="n">to</span> <span class="n">modified</span> <span class="n">CSV</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="running-against-exchange-online-mailboxes">Running Against Exchange Online Mailboxes</h3>
<p>First, execute the script in Audit mode as an admin with <code>Global Administrator</code> or <code>Application Administrator</code> role. For scanning online mailboxes, the Environment parameter should be "Online."</p>
<p>While scanning Exchange Online mailboxes, the script needs an Azure AD app that has delegate permissions for all Exchange Online mailboxes. You can create the application using the script. And once the application is no longer required, you can delete the application using the script as well.</p>
<h4 id="managing-azureadapplication">Managing AzureADApplication:</h4>
<h5 id="examples_2">Examples:</h5>
<p>This syntax runs the script to create an Azure application</p>
<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\&gt;</span> <span class="p">.\</span><span class="n">CVE</span><span class="p">-</span><span class="n">2023</span><span class="p">-</span><span class="n">23397</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-CreateAzureApplication</span>
</code></pre></div>
<p>This syntax runs the script to delete the Azure application created by the script</p>
<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\&gt;</span> <span class="p">.\</span><span class="n">CVE</span><span class="p">-</span><span class="n">2023</span><span class="p">-</span><span class="n">23397</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-DeleteAzureApplication</span>
</code></pre></div>
<h4 id="audit-mode_1">Audit Mode:</h4>
<h5 id="examples_3">Examples:</h5>
<p>This syntax runs the script to Audit all mailboxes in Exchange Online.</p>
<p><strong>NOTE:</strong> Connect to EXO with <a href="https://learn.microsoft.com/en-us/powershell/exchange/connect-to-exchange-online-powershell?view=exchange-ps">Exchange Online PowerShell session</a></p>
<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\&gt;</span> <span class="nb">Get-EXOMailbox</span> <span class="n">-ResultSize</span> <span class="n">Unlimited</span> <span class="p">|</span> <span class="p">.\</span><span class="n">CVE</span><span class="p">-</span><span class="n">2023</span><span class="p">-</span><span class="n">23397</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Environment</span> <span class="s2">&quot;Online&quot;</span>
</code></pre></div>
<p>This syntax runs the script to Audit all mailboxes for items that were during a specific period.</p>
<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\&gt;</span> <span class="nb">Get-EXOMailbox</span> <span class="n">-ResultSize</span> <span class="n">Unlimited</span> <span class="p">|</span> <span class="p">.\</span><span class="n">CVE</span><span class="p">-</span><span class="n">2023</span><span class="p">-</span><span class="n">23397</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Environment</span> <span class="s2">&quot;Online&quot;</span> <span class="n">-StartTimeFilter</span> <span class="s2">&quot;01/01/2023 00:00:00&quot;</span> <span class="n">-EndTimeFilter</span> <span class="s2">&quot;01/01/2024 00:00:00&quot;</span>
</code></pre></div>
<p>This syntax runs the script to Audit all mailboxes by using a certificate to authenticate and using the improved SearchFolder functionality.</p>
<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\&gt;</span> <span class="nb">Get-EXOMailbox</span> <span class="n">-ResultSize</span> <span class="n">Unlimited</span> <span class="p">|</span> <span class="p">.\</span><span class="n">CVE</span><span class="p">-</span><span class="n">2023</span><span class="p">-</span><span class="n">23397</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Environment</span> <span class="n">Online</span> <span class="n">-CertificateThumbprint</span> <span class="p">&lt;</span><span class="n">Thumbprint</span> <span class="n">of</span> <span class="n">the</span> <span class="n">certificate</span><span class="p">&gt;</span> <span class="n">-AppId</span> <span class="p">&lt;</span><span class="n">Application</span> <span class="n">Id</span> <span class="n">of</span> <span class="n">the</span> <span class="s1">&#39;CVE-2023-23397Application&#39;</span> <span class="n">app</span><span class="p">&gt;</span> <span class="n">-Organization</span> <span class="n">contoso</span><span class="p">.</span><span class="n">onmicrosoft</span><span class="p">.</span><span class="n">com</span> <span class="n">-UseSearchFolders</span>
</code></pre></div>
<h4 id="cleanup-mode_1">Cleanup Mode:</h4>
<h5 id="examples_4">Examples:</h5>
<p>This syntax runs the script to clear the problematic property from messages.</p>
<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\&gt;</span> <span class="p">.\</span><span class="n">CVE</span><span class="p">-</span><span class="n">2023</span><span class="p">-</span><span class="n">23397</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Environment</span> <span class="s2">&quot;Online&quot;</span> <span class="n">-CleanupAction</span> <span class="n">ClearProperty</span> <span class="n">-CleanupInfoFilePath</span> <span class="p">&lt;</span><span class="n">Path</span> <span class="n">to</span> <span class="n">modified</span> <span class="n">CSV</span><span class="p">&gt;</span>
</code></pre></div>
<p>This syntax runs the script to delete messages containing the problematic property.</p>
<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\&gt;</span> <span class="p">.\</span><span class="n">CVE</span><span class="p">-</span><span class="n">2023</span><span class="p">-</span><span class="n">23397</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Environment</span> <span class="s2">&quot;Online&quot;</span> <span class="n">-CleanupAction</span> <span class="n">ClearItem</span> <span class="n">-CleanupInfoFilePath</span> <span class="p">&lt;</span><span class="n">Path</span> <span class="n">to</span> <span class="n">modified</span> <span class="n">CSV</span><span class="p">&gt;</span>
</code></pre></div>
<p>This syntax runs the script to delete messages containing the problematic property. It uses a certificate to acquire the required tokens.</p>
<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\&gt;</span> <span class="p">.\</span><span class="n">CVE</span><span class="p">-</span><span class="n">2023</span><span class="p">-</span><span class="n">23397</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Environment</span> <span class="s2">&quot;Online&quot;</span> <span class="n">-CleanupAction</span> <span class="n">ClearItem</span> <span class="n">-CleanupInfoFilePath</span> <span class="p">&lt;</span><span class="n">Path</span> <span class="n">to</span> <span class="n">modified</span> <span class="n">CSV</span><span class="p">&gt;</span> <span class="n">-CertificateThumbprint</span> <span class="p">&lt;</span><span class="n">Thumbprint</span> <span class="n">of</span> <span class="n">the</span> <span class="n">certificate</span><span class="p">&gt;</span> <span class="n">-AppId</span> <span class="p">&lt;</span><span class="n">Application</span> <span class="n">Id</span> <span class="n">of</span> <span class="n">the</span> <span class="s1">&#39;CVE-2023-23397Application&#39;</span> <span class="n">app</span><span class="p">&gt;</span> <span class="n">-Organization</span> <span class="n">contoso</span><span class="p">.</span><span class="n">onmicrosoft</span><span class="p">.</span><span class="n">com</span>
</code></pre></div>
<h2 id="script-execution-errors-and-troubleshooting">Script execution errors and troubleshooting</h2>
<h3 id="exchange-server-doesnt-support-the-requested-version">Exchange Server doesnâ€™t support the requested version</h3>
<p>If there are Exchange 2013 servers in an environment with Exchange 2016 or Exchange 2019, the script may not be able to open mailboxes on Exchange 2013 and may give the following error:</p>
<p><img alt="Exchange Server doesnâ€™t support the requested version screenshot" src="attachments/CVE-2023-23397_screenshot1.png" /></p>
<p>If the above error appears, run the script with the EWSExchange2013 parameter:</p>
<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\&gt;</span> <span class="nb">Get-Mailbox</span> <span class="n">-ResultSize</span> <span class="n">Unlimited</span> <span class="p">|</span> <span class="p">.\</span><span class="n">CVE</span><span class="p">-</span><span class="n">2023</span><span class="p">-</span><span class="n">23397</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Environment</span> <span class="n">Onprem</span> <span class="n">-EWSExchange2013</span>
</code></pre></div>
<h3 id="blocked-autodiscover-redirection">Blocked Autodiscover redirection</h3>
<p><img alt="Blocked Autodiscover redirection screenshot" src="attachments/CVE-2023-23397_screenshot2.png" /></p>
<p>If Autodiscover fails due to a redirection error and the above error appears, provide the EWS URL using the EWSServerURL parameter.</p>
<h3 id="invalid-client-secret-provided">Invalid client secret provided</h3>
<p><img alt="Invalid client secret provided screenshot" src="attachments/CVE-2023-23397_screenshot3.png" /></p>
<p>While running the script in Exchange Online, you might see the above error intermittently. Re-running the script should resolve the issue. If it occurs frequently, then remove the Azure application you have created using -DeleteAzureApplication parameter and then recreate it using -CreateAzureApplication parameter.</p>
<h3 id="cannot-convert-the-microsoftexchangewebservicesdatawebcredentials">"Cannot convert the "Microsoft.Exchange.WebServices.Data.WebCredentials"</h3>
<p><img alt="Incorrect WebServices.dll loaded" src="attachments/CVE-2023-23397_screenshot4.png" /></p>
<p>Incorrect link was provided to download Microsoft.Exchange.WebServices.dll originally that is causing this issue. Follow these steps to correct this problem.</p>
<ul>
<li>Download the correct <a href="https://api.nuget.org/v3-flatcontainer/microsoft.exchange.webservices/2.2.0/microsoft.exchange.webservices.2.2.0.nupkg">NuGet Gallery | Microsoft.Exchange.WebServices.2.2.0</a></li>
<li>Close PowerShell (<strong>CRITICAL</strong>)</li>
<li>Launch new PowerShell session</li>
<li>Run cmdlet again with providing new dll path ( should be <code>lib\40\Microsoft.Exchange.WebServices.dll</code>)</li>
</ul>
<h3 id="unable-to-connect-to-ews-endpoint-401-unauthorized-on-prem">Unable to connect to EWS endpoint - 401 unauthorized - On Prem.</h3>
<p><img alt="401 Unauthorized" src="attachments/CVE-2023-23397_screenshot5.png" /></p>
<p>You are getting a 401 unauthorized when trying to provide the <code>-EWSServerURL</code> parameter to the script. The possible causes can be due to bad credentials provided or the URL endpoint is not working correctly. Try to provide the credentials again to start off with. If that doesn't work, does the URL work when using a browser? You should get a result like this:</p>
<p><img alt="Working EWS Endpoint" src="attachments/CVE-2023-23397_screenshot6.png" /></p>
<p>If you don't get a response looking like this after you are prompted for a username and password, then this could be the problem. Try to see if either the FQDN, <code>https://localhost/ews/exchange.asmx</code>, or <code>https://127.0.0.1/ews/exchange.asmx</code> works instead. If one of those do, use that instead for the <code>-EWSServerURL</code> parameter.</p>
<p><strong>NOTE:</strong> Make sure to include <code>-IgnoreCertificateMismatch</code> if using localhost or 127.0.0.1</p>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">March 29, 2023</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.indexes", "content.action.edit"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.407015b8.min.js"></script>
      
    
  </body>
</html>